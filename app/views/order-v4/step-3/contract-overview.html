{% extends 'layout.html' %}

{% block pageTitle %}
  Buying Catalogue
{% endblock %}

{% block header %}
  {% include "includes/header-proxy.html" %}
  {% endblock%}

  <!-- Breadcrumb goes inside the beforeContent block -->
  {% block beforeContent %}
    <style>
      .nhsuk-expander .nhsuk-details__summary > span,
      .nhsuk-expander .nhsuk-details__summary-text {
        color: black;
        text-decoration: none;
      }

      .nhsuk-expander .nhsuk-details__summary .nhsuk-details__summary-text:before {
        background: url("data:image/svg+xml,%3Csvg class='nhsuk-icon nhsuk-icon__plus' xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 24 24' aria-hidden='true'%3E%3Ccircle cx='12' cy='12' r='10' %3E%3C/circle%3E%3Cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M12 8v8M8 12h8'%3E%3C/path%3E%3C/svg%3E%0A") left -2px center no-repeat;
      }

      .nhsuk-expander[open] .nhsuk-details__summary .nhsuk-details__summary-text:before {
        background: url("data:image/svg+xml,%3Csvg class='nhsuk-icon nhsuk-icon__minus' xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 24 24' aria-hidden='true'%3E%3Ccircle cx='12' cy='12' r='10' %3E%3C/circle%3E%3Cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M8 12h8'%3E%3C/path%3E%3C/svg%3E%0A") left -2px center no-repeat;
      }

      .nhsuk-expander {
        background: none;
      }
    </style>

  {% endblock %}
  <!-- Your page content goes inside the content block -->
  {% block content %}

    {% from 'back-link/macro.njk' import backLink %}

    {{ backLink({
      "href": "order-summary",
      "text": "Go back"
    }) }}

    <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-two-thirds">

        <h1>Supporting documents
          <span class="nhsuk-caption-xl nhsuk-caption--bottom">
            <span class="nhsuk-u-visually-hidden">
              -
            </span>
            Order C000001-01
          </span>
        </h1>

        <!-- Error summary -->

        <div class="nhsuk-error-summary" id="contract-error-summary" aria-labelledby="error-summary-title" role="alert" tabindex="-1" style="display:none">
          <h2 class="nhsuk-error-summary__title" id="error-summary-title">
            There is a problem
          </h2>
          <div class="nhsuk-error-summary__body">
            <p>
              You must correct the following errors
            </p>
            <ul class="nhsuk-list nhsuk-error-summary__list">
              <li class="nhsuk-u-margin-bottom-3">
                <a id="error-summary-implementation" href="#form-group-implementation" style="display:none">You must confirm that you have downloaded the implementation plan milestones template</a>
              </li>
              <li class="nhsuk-u-margin-bottom-3">
                <a id="error-summary-associated-services" href="#form-group-associated-services" style="display:none">You must confirm that you have downloaded the Associated Services billinh and requirements template</a>
              </li>
              <li>
                <a id="error-summary-dpi" href="#form-group-dpi" style="display:none">You must confirm that you have downloaded the data processing information template</a>
              </li>
            </ul>
          </div>
        </div>

        <!-- Lede text -->

        <p class="nhsuk-lede-text">Confirm you’ve downloaded the blank templates to send to the supplier.</p>

        <form id="review-contract-form" action="post-order-guidance">

          <!-- Implementation plan checkbox -->

          <div class="nhsuk-form-group" id="form-group-implementation">

            <fieldset class="nhsuk-fieldset" aria-describedby="contact-hint">
              <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--s">
                <h2 class="nhsuk-fieldset__heading">
                   Implementation plan milestones
                </h2>
              </legend>

              <div class="nhsuk-hint" id="contact-hint">
                Confirm you’ve downloaded the implementation plan milestones template to include with your Call-off Order Form. The supplier must complete it and return it to you.
              </div>

              <span id="implementation-plan-error" class="nhsuk-error-message" style="display: none">
                You must confirm that you have downloaded the implementation plan milestones template
              </span>

              <div class="nhsuk-checkboxes">

                <div class="nhsuk-checkboxes__item">
                  <input class="nhsuk-checkboxes__input" id="contact" name="implementation-checkbox" type="checkbox" value="email">
                  <label class="nhsuk-label nhsuk-checkboxes__label" for="contact">
                    I’ve downloaded the implementation plan milestones template
                  </label>
                </div>

              </div>
            </fieldset>

          </div>

          <br/>

          <p><a href="https://gpitbjss.atlassian.net/wiki/spaces/BG/pages/12209422525/Order+form+template+Implementation+plan+milestones" target="_blank">Download the implementation plan milestones template (opens in a new tab)</a></p>

          <br/>

          <!-- Associated Services checkbox -->

          <div class="nhsuk-form-group" id="form-group-associated-services">

            <fieldset class="nhsuk-fieldset" aria-describedby="contact-hint">
              <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--s">
                <h2 class="nhsuk-fieldset__heading">
                   Associated Service billing and requirements
                </h2>
              </legend>

              <div class="nhsuk-hint" id="contact-hint">
                Confirm you’ve downloaded the Associated Service billing and requirements template to include with your Call-off Order Form. The supplier must complete it and return it to you.
              </div>

              <span id="associated-services-error" class="nhsuk-error-message" style="display: none">
                You must confirm that you have downloaded the Associated Service billing and requirements template
              </span>

              <div class="nhsuk-checkboxes">

                <div class="nhsuk-checkboxes__item">
                  <input class="nhsuk-checkboxes__input" id="contact" name="associated-services-checkbox" type="checkbox" value="email">
                  <label class="nhsuk-label nhsuk-checkboxes__label" for="contact">
                    I’ve downloaded the Associated Service billing and requirements template
                  </label>
                </div>

              </div>
            </fieldset>

          </div>

          <br/>

          <p><a href="https://gpitbjss.atlassian.net/wiki/spaces/BG/pages/12209389727/Order+form+template+Associated+Service+billing+and+requirements" target="_blank">Download the Associated Service billing and requirements template (opens in a new tab)</a></p>

          <br/>

          <!-- DPI checkbox -->


          <div class="nhsuk-form-group" id="form-group-dpi">

            <fieldset class="nhsuk-fieldset" aria-describedby="contact-hint">
              <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--s">
                <h2 class="nhsuk-fieldset__heading">
                   Data processing information
                </h2>
              </legend>

              <div class="nhsuk-hint" id="contact-hint">
                 Confirm you’ve downloaded the data processing information template to include with your Call-off Order Form. The supplier must complete it and return it to you.
              </div>

              <span id="dpi-error" class="nhsuk-error-message" style="display: none">
                You must confirm that you have downloaded the data processing information template
              </span>

              <div class="nhsuk-checkboxes">

                <div class="nhsuk-checkboxes__item">
                  <input class="nhsuk-checkboxes__input" id="contact" name="dpi-checkbox" type="checkbox" value="email">
                  <label class="nhsuk-label nhsuk-checkboxes__label" for="contact">
                    I’ve downloaded the data processing information template
                  </label>
                </div>

              </div>
            </fieldset>

          </div>

          <br/>

          <p><a href="https://gpitbjss.atlassian.net/wiki/spaces/BG/pages/12207980954/Order+form+template+Data+processing+information" target="_blank">Download the data processing information template (opens in a new tab)</a></p>

          <hr/>

          <!-- Download PDF -->

          <h2 class="nhsuk-heading-m">Preview order</h2>

          <p>You can download and review your order before sending it to the supplier for signature.</p>

          <a class="nhsuk-button nhsuk-button--secondary" type="button" href="/files/amend_order_pdf.pdf" download="amend_order_pdf.pdf">
            Download order (PDF)
          </a>

          <br/>

          <!--Complete order -->

          <h2 class="nhsuk-heading-m">Complete order</h2>

          <p>After agreeing the contents of your order with the supplier, mark it complete, download your Call-off Order Form and send it to the supplier for signature. Make sure you include the blank templates for the supplier to fill out.</p>

          <p>Once you receive a signed copy of your Call-off Order Form and the completed templates from the supplier, sign it and your Call-off Order will be finalised.</p>

          <br/>

          {{ button({
            "text": "Complete order",
            "type": "submit",
            "classes": "nhsuk-u-margin-right-3"
          }) }}

          {{ button({
            "text": "Save for later",
            "type": "button",
            "classes": "nhsuk-button--secondary",
            "href": "../order-dashboard-in-progress"
          }) }}

        </form>

      </div>
    </div>

    <br/><br/>

    <!-- Checkbox validation -->

    <script>

      $("form").submit(function (e) {

        if (!$('input[name=implementation-checkbox]').is(':checked')) {
          $('#implementation-plan-error').show();
          $('#form-group-implementation').addClass('nhsuk-form-group--error');
          $('#error-summary-implementation').show();
        } else {
          $('#implementation-plan-error').hide();
          $('#form-group-implementation').removeClass('nhsuk-form-group--error');
          $('#error-summary-implementation').hide();
        }

        if (!$('input[name=associated-services-checkbox]').is(':checked')) {
          $('#associated-services-error').show();
          $('#form-group-associated-services').addClass('nhsuk-form-group--error');
          $('#error-summary-associated-services').show();
        } else {
          $('#associated-services-error').hide();
          $('#form-group-associated-services').removeClass('nhsuk-form-group--error');
          $('#error-summary-associated-services').hide();
        }

        if (!$('input[name=dpi-checkbox]').is(':checked')) {
          $('#dpi-error').show();
          $('#form-group-dpi').addClass('nhsuk-form-group--error');
          $('#error-summary-dpi').show();
        } else {
          $('#dpi-error').hide();
          $('#form-group-dpi').removeClass('nhsuk-form-group--error');
          $('#error-summary-dpi').hide();
        }

        if (!$('input[name=implementation-checkbox]').is(':checked') || !$('input[name=associated-services-checkbox]').is(':checked') || !$('input[name=dpi-checkbox]').is(':checked')) {
          $('#contract-error-summary').show();
          e.preventDefault();
        } else {
          return true;
        }

      });
    </script>

  {% endblock %}

  {% block footer %}
    {% include "includes/footer.html" %}
  {% endblock %}
